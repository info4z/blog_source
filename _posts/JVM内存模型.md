---
title: JVM内存模型
date: 2020-03-13
categories:
- 高性能编程
tags: 
- 多线程并发编程
- 线程安全
---





> 理解 jvm 内存模型可以有助于分析解决多线程种遇到的问题



## 一 : 多线程中的问题

1. 所见非所得
2. 无法肉眼去检测程序的准确性
3. 不同的运行平台有不同的表现
4. 错误很难重现

## 二 : 从内存结构到内存模型

每个线程都有自己的工作内存; 如果想要数据共享, 需要存放在主内存中

![](https://gcore.jsdelivr.net/gh/info4z/blog_images@main/images/image-20230115181740141.png)

因为这种内存结构, 在多线程下数据交互会有各种情况出现

## 三 : 工作内存缓存

cpu 运行时, 与 cpu 交互的主要是 cpu 缓存, 此时可能会出现不同 cpu 缓存中的数据不一致的情况

![](https://gcore.jsdelivr.net/gh/info4z/blog_images@main/images/image-20230115181751188.png)

## 四 : 内存模型的含义

内存模型描述程序的可能行为

**java 编程语言内存模型**通过检查执行跟踪中的每个操作, 并根据某些规则检查该读操作观察到的写操作是否有效来工作

只要程序的所有执行产生结果都可以由内存模型预测; 具体的实现者任意实现, 包括操作的重新排序和删除不必要的同步

内存模型决定了在程序的每个点上可以读取什么值

